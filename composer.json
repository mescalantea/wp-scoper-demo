{
    "name": "mescalantea/wp-scoper-demo",
    "type": "wordpress-plugin",
    "description": "A demo plugin to show how to use PHP Scoper",
    "config": {
        "platform": {
            "php": "7.2.0"
        },
        "preferred-install": "dist",
        "sort-packages": true,
        "allow-plugins": {
            "composer/installers": true,
            "dealerdirect/phpcodesniffer-composer-installer": true
        }
    },
    "autoload": {
        "classmap": [
            "src/"
        ]
    },
    "autoload-dev": {
        "classmap": [
            "tests/"
        ]
    },
    "require": {
        "php-di/php-di": "~6.0"
    },
    "require-dev": {
        "phpunit/phpunit": ">5.0",
        "yoast/phpunit-polyfills": "^1.0",
        "dealerdirect/phpcodesniffer-composer-installer": "^1.0.0",
        "humbug/php-scoper": "^0.13.9"
    },
    "minimum-stability": "dev",
    "prefer-stable": true,
    "repositories": [
        {
            "type": "vcs",
            "url": "git@gitlab.com:midrinet/toolkit.git"
        }
    ],
    "scripts": {
        "post-install-cmd": [
            "@prefix-dependencies"
        ],
        "post-update-cmd": [
            "@prefix-dependencies"
        ],
        "prefix-dependencies": [
            "@composer --working-dir=php-scoper install",
            "php-scoper add-prefix --output-dir=./includes --force",
            "@autoload-src",
            "@autoload-includes",
            "@composer dump-autoload --no-dev",
            "cp vendor/composer/autoload_files.php includes/vendor/",
            "@composer dump-autoload"
        ],
        "autoload-src": [
            "echo '{ \"autoload\": { \"classmap\": [\"\"] } }' > src/composer.json",
            "@composer --working-dir=src dump-autoload --classmap-authoritative --no-interaction",
            "cp src/vendor/composer/autoload_classmap.php src/",
            "rm -rf src/vendor && rm src/composer.json",
            "mkdir -p src/vendor/composer && mv src/autoload_classmap.php src/vendor/composer/"
        ],
        "autoload-includes": [
            "echo '{ \"autoload\": { \"classmap\": [\"\"] } }' > includes/composer.json",
            "@composer --working-dir=includes dump-autoload --classmap-authoritative --no-interaction",
            "cp includes/vendor/composer/autoload_classmap.php includes/",
            "rm -rf includes/vendor && rm includes/composer.json",
            "mkdir -p includes/vendor/composer && mv includes/autoload_classmap.php includes/vendor/composer/"
        ],
        "php-scoper-excludes": [
            "rm -rf php-scoper/excludes",
            "mkdir -p php-scoper/excludes",
            "git clone https://github.com/snicco/php-scoper-woocommerce-excludes.git",
            "cp -r php-scoper-woocommerce-excludes/generated php-scoper/excludes/woocommerce",
            "rm -rf php-scoper-woocommerce-excludes",
            "git clone https://github.com/snicco/php-scoper-wp-cli-excludes.git",
            "cp -r php-scoper-wp-cli-excludes/generated php-scoper/excludes/wp-cli",
            "rm -rf php-scoper-wp-cli-excludes",
            "git clone https://github.com/snicco/php-scoper-wordpress-excludes.git",
            "cp -r php-scoper-wordpress-excludes/generated php-scoper/excludes/wordpress",
            "rm -rf php-scoper-wordpress-excludes"
        ]
    }
}